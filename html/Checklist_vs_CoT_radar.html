<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>Checklist vs. CoT 指标雷达图</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <style>
    :root {
      font-family: "SF Pro Display", "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Microsoft Yahei", sans-serif;
      color: #0f172a;
      background: #f5f6fa;
    }
    body {
      margin: 0;
      padding: 24px 32px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      min-height: 100vh;
      box-sizing: border-box;
    }
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 24px;
    }
    h1 {
      margin: 0;
      font-size: 30px;
      font-weight: 600;
      color: #0f172a;
    }
    .subtitle {
      margin: 4px 0 0;
      color: #475569;
      font-size: 15px;
    }
    .toolbar {
      display: flex;
      gap: 12px;
    }
    button {
      border: none;
      border-radius: 999px;
      padding: 10px 18px;
      margin-right: 10px;
      font-size: 14px;
      cursor: pointer;
      background: #e2e8f0;
      color: #0f172a;
      transition: all 0.2s ease;
    }
    button.active {
      background: #2563eb;
      color: #fff;
      box-shadow: 0 4px 14px rgba(37, 99, 235, 0.35);
    }
    #chartContainer {
      position: relative;
      width: 100%;
      height: calc(100vh - 140px);
    }
    #chart {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.08);
    }
    /* 左侧悬浮的小表格，不改变雷达图尺寸 */
    #tableWrap {
      position: absolute;
      top: 16px;
      left: 16px;
      width: 340px; /* 缩小一些 */
      max-height: 75%;
      overflow: hidden;
      z-index: 10;
      font-size: 12.5px;
    }
  </style>
</head>
<body>
  <div class="header">
    <div>
      <h1>Checklist vs. CoT 指标雷达图</h1>
      <p class="subtitle">点击按钮切换「多维度评估」与「官方指标」；复杂度得分已线性映射到 0~5。</p>
    </div>
    <div class="toolbar">
      <button id="btnMulti" class="active">多维度评估</button>
      <button id="btnOfficial">官方指标</button>
    </div>
  </div>
  <div id="chartContainer">
    <div id="tableWrap">
      <h3 id="tableTitle" style="margin:16px 0 8px 0; color:#0f172a;">数据表</h3>
      <div style="overflow:auto; background:#fff; border-radius:12px; box-shadow:0 10px 25px rgba(15,23,42,0.08);">
        <table id="dataTable" style="width:100%; border-collapse:collapse; min-width:0;">
          <thead id="thead"></thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>
    </div>
    <div id="chart"></div>
  </div>

  <script>
    const palette = [
      '#2563eb', // checklist
      '#10b981', // cot_explicit
      '#f97316', // cot_implicit
    ];

    const multiIndicator = [
      { name: '可读性', min: 1.5, max: 4, color: '#0f172a' },
      { name: '流畅性', min: 1.5, max: 4, color: '#0f172a' },
      { name: '完整性', min: 1.5, max: 4, color: '#0f172a' },
      { name: '鲁棒性', min: 1.5, max: 3, color: '#0f172a' },
      { name: '安全性', min: 2.5, max: 4.2, color: '#0f172a' },
      { name: '静态复杂度 (×5)', min: 1.6, max: 2.4, color: '#0f172a' },
    ];

    const multiSeries = [
      { name: 'checklist', value: [2.64, 2.58, 2.21, 1.865, 3.725, 2.0072] },
      { name: 'cot_explicit', value: [2.705, 2.595, 2.31, 1.96, 3.71, 2.0002] },
      { name: 'cot_implicit', value: [2.66, 2.56, 2.3, 2.0, 3.71, 1.8906] },
    ];

    const officialIndicator = [
      { name: 'CSR', max: 0.08, color: '#0f172a' },
      { name: 'SSR', max: 0.45, color: '#0f172a' },
      { name: 'RSR', max: 0.35, color: '#0f172a' },
      { name: 'CCSR', max: 0.33, color: '#0f172a' },
    ];

    const officialSeries = [
      { name: 'checklist', value: [0.03, 0.434225193408243, 0.32781015656170476, 0.2638823648616608] },
      { name: 'cot_explicit', value: [0.03, 0.41870801912655636, 0.31328021198357897, 0.2657424422198032] },
      { name: 'cot_implicit', value: [0.03, 0.4085587973902603, 0.30976227496273984, 0.2559806424225931] },
    ];

    const chart = echarts.init(document.getElementById('chart'));

    function makeOption(title, indicator, seriesData) {
      return {
        title: {
          text: title,
          right: 20,
          top: '18%',
          textAlign: 'left',
          textStyle: { fontSize: 18, fontWeight: 600 },
        },
        tooltip: {
          trigger: 'item',
          formatter: params => {
            const lines = params.value
              .map((val, idx) => `${indicator[idx].name}: ${val.toFixed(3)}`)
              .join('<br>');
            return `<strong>${params.seriesName}</strong><br>${lines}`;
          },
        },
        legend: {
          data: seriesData.map(s => s.name),
          orient: 'vertical',
          right: 20,
          top: '32%',
        },
        radar: {
          indicator: indicator.map(item => ({ ...item, name: `{label|${item.name}}` })),
          radius: '85%',
          splitNumber: 6,
          splitArea: { areaStyle: { color: ['rgba(37,99,235,0.04)', 'rgba(148,163,184,0.05)'] } },
          splitLine: { lineStyle: { color: '#cbd5f5' } },
          axisLine: { lineStyle: { color: '#cbd5f5' } },
          name: {
            formatter: value => value,
            rich: {
              label: {
                color: '#0f172a',
                fontSize: 14,
                fontWeight: 600,
                textShadowColor: 'rgba(15,23,42,0.12)',
                textShadowBlur: 4,
              },
            },
          },
        },
        series: seriesData.map((series, idx) => ({
          name: series.name,
          type: 'radar',
          symbol: 'circle',
          symbolSize: 7,
          lineStyle: { width: 3, color: palette[idx % palette.length] },
          itemStyle: { color: palette[idx % palette.length] },
          areaStyle: { opacity: 0.28 },
          data: [series.value],
        })),
      };
    }

    function render(mode) {
      if (mode === 'multi') {
        chart.setOption(makeOption('多维度评估（质量 + 复杂度）', multiIndicator, multiSeries));
        btnMulti.classList.add('active');
        btnOfficial.classList.remove('active');
        renderTable('multi');
      } else {
        chart.setOption(makeOption('官方指标（CodeIF 四指标）', officialIndicator, officialSeries));
        btnMulti.classList.remove('active');
        btnOfficial.classList.add('active');
        renderTable('official');
      }
    }

    const btnMulti = document.getElementById('btnMulti');
    const btnOfficial = document.getElementById('btnOfficial');
    btnMulti.addEventListener('click', () => render('multi'));
    btnOfficial.addEventListener('click', () => render('official'));

    render('multi');
    window.addEventListener('resize', () => chart.resize());

    // 渲染表格（与雷达图数据同步）
    function renderTable(mode) {
      const thead = document.getElementById('thead');
      const tbody = document.getElementById('tbody');
      const title = document.getElementById('tableTitle');
      thead.innerHTML = '';
      tbody.innerHTML = '';
      let headers = [];
      let rows = [];
      if (mode === 'multi') {
        title.textContent = '多维度评估（质量 + 复杂度）数据表';
        headers = ['策略', '可读性', '流畅性', '完整性', '鲁棒性', '安全性', '静态复杂度(×5)'];
        rows = multiSeries.map(s => [s.name, ...s.value.map(v => typeof v === 'number' ? v.toFixed(3) : v)]);
      } else {
        title.textContent = '官方指标（CodeIF 四指标）数据表';
        headers = ['策略', 'CSR', 'SSR', 'RSR', 'CCSR'];
        rows = officialSeries.map(s => [s.name, ...s.value.map(v => typeof v === 'number' ? v.toFixed(6) : v)]);
      }
      // 头
      const th = headers.map(h => `<th style="text-align:center; padding:10px 12px; border-bottom:1px solid #e5e7eb; color:#0f172a; background:#f8fafc;">${h}</th>`).join('');
      thead.innerHTML = `<tr>${th}</tr>`;
      // 行
      rows.forEach(r => {
        const tds = r.map((c,i) => `<td style="text-align:${i===0?'left':'right'}; padding:10px 12px; border-bottom:1px solid #eef2f7; color:#111827;">${c}</td>`).join('');
        tbody.insertAdjacentHTML('beforeend', `<tr>${tds}</tr>`);
      });
    }
  </script>
</body>
</html>
